# Automation pipeline configuration
# Adjustable parameters for batch simulations, analysis, and report compilation.

version: 1
random_seed: 42

lattice:
  sizes:
    - [8, 8]
    - [12, 12]
    - [16, 16]
  disorder_values: [0.0, 0.1, 0.2]

noise:
  gamma_scan_logspace: {start_exp: -3, end_exp: 1, points: 25}
  target_time: 5.0
  dt: 0.02
  refinement_factor: 2
  # Backend controls for integrator (optional; defaults preserve existing behavior)
  backend: dm               # options: dm, statevec, auto, tn, nqs
  liouville_stepper: rk4    # options: rk4, krylov
  auto_N_threshold: 2048    # use statevec for gamma=0 if N>=threshold when backend=auto
  gamma_krylov_threshold: 1.0e-6  # prefer Krylov Liouvillian when |gamma|<=thr and backend=auto
  tn_backend: quimb_mps     # options: quimb_mps
  nqs_backend: netket_nqs   # options: netket_nqs

analysis:
  perform_convergence: true
  perform_traj_variance: true
  perform_phase_diagram: true
  perform_msd: true
  perform_otoc: true
  perform_logical: true
  enhanced_ramsey: false
  bootstrap_samples: 256
  msd_time_points: 80
  perform_fss: true         # enable finite-size scaling for medium run
  fss_sizes: [8, 12, 16, 20]
  # Information geometry (Fisher) analysis
  perform_info_geom: true
  info_geom_epsilon: 0.05
  info_geom_floor: 1.0e-12
  # Autonomous Discovery
  perform_autonomous_discovery: true
  autonomous_discovery_iterations: 20
  autonomous_discovery_anomaly_threshold: 3.0
  autonomous_discovery_strategy_adapt_threshold: 5

ptq:
  enable_delta: false   # Set true to emit instanton tunneling Î” metrics
  r0: 1.0
  gamma_c: 1.0
  u: 1.0
  M: 1000.0
  require_valid: false   # If true, quality gates fail when instanton validity not satisfied

quality_gates:
  max_trace_deviation: 1.0e-9
  min_dt_order: 3.5
  max_bootstrap_halfwidth: 0.05
  fractal_transport_tolerance: 0.15
  positivity_tolerance: 1.0e-9   # allowed small negative eigenvalue due to numeric noise
  max_local_error: 1.0e-4        # adaptive step local error ceiling
  max_forced_d2_fraction: 0.3    # gate: forced D2 ratio limit
  min_logical_fidelity: 0.6      # gate: minimal acceptable logical process fidelity
  # Fisher light gate (optional bounds; evaluated only if metrics are present)
  fisher_gamma_min: 10.0     # calibrated from L=8 quick run (~200), set a loose lower bound
  fisher_gamma_max: 5.0e4    # generous upper bound to avoid clipping larger lattices
  fisher_gamma_sqrt_min: 2.0 # sqrt(F) ~ 14 in L=8 quick run; set a loose lower bound
  fisher_gamma_sqrt_max: 500.0
  # Autonomous Discovery quality gates
  min_auto_discoveries: 5      # minimum discoveries expected per run
  min_auto_efficiency: 0.1     # minimum discovery efficiency (discoveries/iterations)
  max_auto_anomalies_ratio: 0.5 # maximum ratio of anomalies to iterations

report:
  build_latex: true
  master_tex: blueprint_master.tex
  output_pdf: blueprint_master.pdf
  generate_manuscript: true
  manuscript_out: manuscript/auto
  keep_intermediate: false

output:
  root_dir: automation_runs
  compress_archives: true

parallel:
  workers: 2

logging:
  level: INFO
  json_metadata: true
