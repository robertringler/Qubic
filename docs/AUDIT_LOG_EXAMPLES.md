# QRATUM Audit Log Examples

## Overview

This document provides examples of audit logs generated by the QRATUM platform, demonstrating the Merkle-chained event tracking system.

## Audit Log Structure

Each audit event contains:

- `event_type`: Type of event
- `data`: Event-specific data
- `timestamp`: Unix timestamp
- `previous_hash`: SHA-256 hash of previous event
- `hash`: SHA-256 hash of this event

## Example 1: Contract Execution Flow

### Complete Audit Trail

```json
{
  "events": [
    {
      "event_type": "contract_created",
      "data": {
        "contract_id": "c7f3a8b2-1234-5678-90ab-cdef12345678",
        "operation": "legal_reasoning",
        "user_id": "user_123",
        "timestamp": 1703260795.123
      },
      "timestamp": 1703260795.123,
      "previous_hash": "a3f2e1d9c8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1",
      "hash": "9d4e3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4"
    },
    {
      "event_type": "contract_execution_started",
      "data": {
        "contract_id": "c7f3a8b2-1234-5678-90ab-cdef12345678",
        "operation": "legal_reasoning",
        "safety_level": "routine",
        "timestamp": 1703260795.234
      },
      "timestamp": 1703260795.234,
      "previous_hash": "9d4e3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4",
      "hash": "f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5"
    },
    {
      "event_type": "vertical_module_invoked",
      "data": {
        "vertical": "JURIS",
        "contract_id": "c7f3a8b2-1234-5678-90ab-cdef12345678",
        "timestamp": 1703260795.345
      },
      "timestamp": 1703260795.345,
      "previous_hash": "f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5",
      "hash": "e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6"
    },
    {
      "event_type": "contract_execution_completed",
      "data": {
        "contract_id": "c7f3a8b2-1234-5678-90ab-cdef12345678",
        "status": "completed",
        "execution_time": 0.125,
        "timestamp": 1703260795.470
      },
      "timestamp": 1703260795.470,
      "previous_hash": "e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6",
      "hash": "d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7"
    }
  ],
  "count": 4,
  "merkle_root": "d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a0f9e8d7",
  "chain_verified": true
}
```

## Example 2: Checkpoint Creation

```json
{
  "event_type": "checkpoint_created",
  "data": {
    "checkpoint_id": "ckpt_20231222_120000",
    "description": "Daily automated checkpoint",
    "contracts_count": 1247,
    "chain_length": 5234,
    "timestamp": 1703260800.000
  },
  "timestamp": 1703260800.000,
  "previous_hash": "b8a7f6e5d4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9b8",
  "hash": "c9b8a7f6e5d4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9"
}
```

## Example 3: Cross-Domain Synthesis

### NEXUS Multi-Domain Integration

```json
{
  "events": [
    {
      "event_type": "cross_domain_synthesis_initiated",
      "data": {
        "domains": ["VITRA", "ECORA", "FLUXA"],
        "query": "Sustainable pharmaceutical manufacturing",
        "user_id": "researcher_456",
        "timestamp": 1703261000.000
      },
      "timestamp": 1703261000.000,
      "previous_hash": "...",
      "hash": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1"
    },
    {
      "event_type": "vertical_consulted",
      "data": {
        "vertical": "VITRA",
        "operation": "drug_synthesis_analysis",
        "result_summary": "Green chemistry synthesis options identified",
        "timestamp": 1703261001.234
      },
      "timestamp": 1703261001.234,
      "previous_hash": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1",
      "hash": "b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2"
    },
    {
      "event_type": "vertical_consulted",
      "data": {
        "vertical": "ECORA",
        "operation": "carbon_impact_assessment",
        "result_summary": "40% carbon reduction potential identified",
        "timestamp": 1703261002.345
      },
      "timestamp": 1703261002.345,
      "previous_hash": "b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2",
      "hash": "c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3"
    },
    {
      "event_type": "vertical_consulted",
      "data": {
        "vertical": "FLUXA",
        "operation": "supply_chain_optimization",
        "result_summary": "Distributed manufacturing network proposed",
        "timestamp": 1703261003.456
      },
      "timestamp": 1703261003.456,
      "previous_hash": "c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3",
      "hash": "d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4"
    },
    {
      "event_type": "cross_domain_synthesis_completed",
      "data": {
        "insights_generated": 3,
        "confidence_score": 0.87,
        "novelty_score": 0.76,
        "timestamp": 1703261005.678
      },
      "timestamp": 1703261005.678,
      "previous_hash": "d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4",
      "hash": "e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5"
    }
  ]
}
```

## Example 4: Safety Violation Detection

```json
{
  "event_type": "safety_violation_detected",
  "data": {
    "vertical": "AEGIS",
    "operation": "exploit_analysis",
    "violation_type": "prohibited_operation",
    "user_id": "user_789",
    "blocked": true,
    "timestamp": 1703262000.000
  },
  "timestamp": 1703262000.000,
  "previous_hash": "...",
  "hash": "f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6"
}
```

## Example 5: System Rollback

```json
{
  "events": [
    {
      "event_type": "rollback_initiated",
      "data": {
        "checkpoint_id": "ckpt_20231222_110000",
        "reason": "Integrity issue detected",
        "initiated_by": "operator_001",
        "timestamp": 1703263000.000
      },
      "timestamp": 1703263000.000,
      "previous_hash": "...",
      "hash": "a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7"
    },
    {
      "event_type": "state_restored",
      "data": {
        "checkpoint_id": "ckpt_20231222_110000",
        "contracts_restored": 1180,
        "timestamp": 1703263005.000
      },
      "timestamp": 1703263005.000,
      "previous_hash": "a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7",
      "hash": "b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8"
    },
    {
      "event_type": "rollback_completed",
      "data": {
        "success": true,
        "verification_passed": true,
        "timestamp": 1703263010.000
      },
      "timestamp": 1703263010.000,
      "previous_hash": "b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8",
      "hash": "c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9"
    }
  ]
}
```

## Example 6: Multi-User Collaboration

```json
{
  "events": [
    {
      "event_type": "collaboration_session_started",
      "data": {
        "session_id": "collab_abc123",
        "participants": ["user_001", "user_002", "user_003"],
        "verticals": ["JURIS", "CAPRA"],
        "timestamp": 1703264000.000
      },
      "timestamp": 1703264000.000,
      "previous_hash": "...",
      "hash": "d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0"
    },
    {
      "event_type": "contract_executed",
      "data": {
        "contract_id": "contract_xyz789",
        "user_id": "user_001",
        "vertical": "JURIS",
        "operation": "contract_analysis",
        "timestamp": 1703264010.000
      },
      "timestamp": 1703264010.000,
      "previous_hash": "d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0",
      "hash": "e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1"
    },
    {
      "event_type": "contract_executed",
      "data": {
        "contract_id": "contract_def456",
        "user_id": "user_002",
        "vertical": "CAPRA",
        "operation": "risk_assessment",
        "timestamp": 1703264020.000
      },
      "timestamp": 1703264020.000,
      "previous_hash": "e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1",
      "hash": "f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2"
    }
  ]
}
```

## Verifying Audit Logs

### Verify Chain Integrity

```bash
# Get system proof
curl http://localhost:8001/api/v1/system/proof

# Response:
{
  "merkle_root": "f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2",
  "chain_length": 5234,
  "integrity_verified": true,
  "timestamp": 1703264030.000
}
```

### Query Specific Events

```bash
# Get all events for a contract
curl "http://localhost:8001/api/v1/audit/trail?contract_id=c7f3a8b2-1234-5678-90ab-cdef12345678"

# Get events by type
curl "http://localhost:8001/api/v1/audit/trail?event_type=checkpoint_created"

# Get events in time range
curl "http://localhost:8001/api/v1/audit/trail?start_time=1703260000&end_time=1703264000"
```

## Export Audit Logs

### JSON Export

```bash
curl http://localhost:8001/api/v1/audit/trail > audit-export-$(date +%Y%m%d).json
```

### CSV Export

```bash
curl http://localhost:8001/api/v1/audit/trail | \
  jq -r '.events[] | [.event_type, .timestamp, .data.user_id // "system", .hash[0:16]] | @csv' \
  > audit-export-$(date +%Y%m%d).csv
```

## Compliance Reports

### HIPAA Audit Report

```json
{
  "report_type": "HIPAA_Compliance",
  "period": "2023-12-01 to 2023-12-31",
  "summary": {
    "total_operations": 12847,
    "phi_access_events": 1247,
    "authorized_users": 23,
    "violations": 0,
    "audit_logs_verified": true
  },
  "details": {
    "phi_access_by_user": [
      {"user_id": "doctor_001", "access_count": 234},
      {"user_id": "nurse_002", "access_count": 189}
    ],
    "operations": [
      {"operation": "patient_record_access", "count": 856},
      {"operation": "prescription_review", "count": 391}
    ]
  },
  "merkle_proofs": [
    "Start: a1b2c3d4...",
    "End: f6a7b8c9..."
  ]
}
```

### SOC 2 Audit Trail

```json
{
  "report_type": "SOC2_Type2",
  "control_objective": "Logical and Physical Access Controls",
  "evidence": {
    "all_access_logged": true,
    "merkle_chain_verified": true,
    "unauthorized_access_attempts": 0,
    "successful_authentications": 8234,
    "failed_authentications": 12
  },
  "audit_period": "2023-01-01 to 2023-12-31",
  "conclusion": "Controls operating effectively"
}
```

---

## Best Practices

1. **Regular Exports:** Export audit logs weekly for archival
2. **Integrity Checks:** Verify Merkle chain integrity daily
3. **Long-term Storage:** Retain audit logs for 7+ years for compliance
4. **Immutable Storage:** Store audit logs on write-once media
5. **Encrypted Backups:** Encrypt audit log backups at rest
6. **Access Controls:** Restrict audit log access to authorized personnel only
7. **Tamper Detection:** Monitor for any changes to historical audit logs

---

## Support

For questions about audit logs:

- Documentation: <https://docs.qratum.io/audit-logs>
- Email: <compliance@qratum.io>
- Security: <security@qratum.io>
